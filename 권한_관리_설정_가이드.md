# ê¶Œí•œ ê´€ë¦¬ ì„¤ì • ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

Portalì—ì„œ ì‚¬ìš©ìë³„ë¡œ ì„œë¸Œì‹œìŠ¤í…œ ì ‘ê·¼ ê¶Œí•œì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

## ğŸ”§ Firestore ì»¬ë ‰ì…˜ ìƒì„±

### 1. Firebase ì½˜ì†” ì ‘ì†

1. [Firebase Console](https://console.firebase.google.com/) ì ‘ì†
2. `portal-fc7ae` í”„ë¡œì íŠ¸ ì„ íƒ
3. **Firestore Database** ë©”ë‰´ í´ë¦­

### 2. `userPermissions` ì»¬ë ‰ì…˜ ìƒì„±

1. **ì»¬ë ‰ì…˜ ì‹œì‘** ë²„íŠ¼ í´ë¦­
2. ì»¬ë ‰ì…˜ ID: `userPermissions` ì…ë ¥
3. ë¬¸ì„œ ID: **Firebase Auth UID** ì…ë ¥ (ì‚¬ìš©ìì˜ Firebase UID)

### 3. ë¬¸ì„œ êµ¬ì¡°

ê° ë¬¸ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤:

```json
{
  "userId": "firebase_uid_ì—¬ê¸°",
  "email": "user@example.com",
  "name": "ì‚¬ìš©ì ì´ë¦„",
  "permissions": {
    "work-schedule": "read",
    "purchase": "read",
    "naver-ranking": "read",
    "naver-refund": "read",
    "ranking-tracker": "read",
    "manual-management": "read",
    "chatbot-management": "none",
    "system-login": "none"
  },
  "role": "user",
  "createdAt": "2025-01-XX",
  "updatedAt": "2025-01-XX"
}
```

## ğŸ“ ê¶Œí•œ ë ˆë²¨ ì„¤ëª…

### PermissionLevel
- `none`: ì ‘ê·¼ ë¶ˆê°€ (ì‹œìŠ¤í…œ ì¹´ë“œ ìˆ¨ê¹€)
- `read`: ì¡°íšŒë§Œ ê°€ëŠ¥
- `write`: ì¡°íšŒ ë° ìˆ˜ì • ê°€ëŠ¥
- `admin`: ê´€ë¦¬ ê¶Œí•œ (ëª¨ë“  ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥)

### Role (ì „ì²´ ê¶Œí•œ ë ˆë²¨)
- `user`: ì¼ë°˜ ì‚¬ìš©ì (ê°œë³„ ê¶Œí•œ í™•ì¸)
- `admin`: ê´€ë¦¬ì (ëŒ€ë¶€ë¶„ ì‹œìŠ¤í…œ ì ‘ê·¼ ê°€ëŠ¥, íŠ¹ì • ì‹œìŠ¤í…œì— `none` ì„¤ì • ì‹œ ì œì™¸)
- `super_admin`: ìµœê³  ê´€ë¦¬ì (ëª¨ë“  ì‹œìŠ¤í…œ ì ‘ê·¼ ê°€ëŠ¥)

## ğŸ¯ ê¶Œí•œ ì„¤ì • ì˜ˆì‹œ

### ì˜ˆì‹œ 1: ì¼ë°˜ ì‚¬ìš©ì (work-scheduleë§Œ ì ‘ê·¼)

```json
{
  "userId": "user_firebase_uid",
  "email": "employee@example.com",
  "name": "í™ê¸¸ë™",
  "permissions": {
    "work-schedule": "read",
    "purchase": "none",
    "naver-ranking": "none",
    "naver-refund": "none",
    "ranking-tracker": "none",
    "manual-management": "read",
    "chatbot-management": "none",
    "system-login": "none"
  },
  "role": "user",
  "createdAt": "2025-01-XX",
  "updatedAt": "2025-01-XX"
}
```

### ì˜ˆì‹œ 2: ê´€ë¦¬ì (ëŒ€ë¶€ë¶„ ì ‘ê·¼ ê°€ëŠ¥)

```json
{
  "userId": "admin_firebase_uid",
  "email": "admin@example.com",
  "name": "ê´€ë¦¬ì",
  "permissions": {
    "work-schedule": "admin",
    "purchase": "admin",
    "naver-ranking": "read",
    "naver-refund": "read",
    "ranking-tracker": "read",
    "manual-management": "admin",
    "chatbot-management": "admin",
    "system-login": "admin"
  },
  "role": "admin",
  "createdAt": "2025-01-XX",
  "updatedAt": "2025-01-XX"
}
```

### ì˜ˆì‹œ 3: ìµœê³  ê´€ë¦¬ì (ëª¨ë“  ê¶Œí•œ)

```json
{
  "userId": "super_admin_firebase_uid",
  "email": "superadmin@example.com",
  "name": "ìµœê³  ê´€ë¦¬ì",
  "permissions": {},
  "role": "super_admin",
  "createdAt": "2025-01-XX",
  "updatedAt": "2025-01-XX"
}
```

## ğŸ” Firebase Auth UID í™•ì¸ ë°©ë²•

### ë°©ë²• 1: Firebase ì½˜ì†”ì—ì„œ í™•ì¸
1. Firebase Console â†’ **Authentication** ë©”ë‰´
2. **Users** íƒ­ì—ì„œ ì‚¬ìš©ì ì„ íƒ
3. **User UID** ë³µì‚¬

### ë°©ë²• 2: ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í™•ì¸
1. Portalì— ë¡œê·¸ì¸
2. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ (F12) ì—´ê¸°
3. Console íƒ­ì—ì„œ ë‹¤ìŒ ì½”ë“œ ì‹¤í–‰:
   ```javascript
   // Firebase Auth ì‚¬ìš©ì ì •ë³´ í™•ì¸
   import { auth } from '@/lib/firebase';
   console.log(auth.currentUser?.uid);
   ```

## ğŸ› ï¸ ê¶Œí•œ ê´€ë¦¬ API (ì„ íƒì‚¬í•­)

ê¶Œí•œì„ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ ê´€ë¦¬í•˜ë ¤ë©´ APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

### ê¶Œí•œ ì¡°íšŒ
```typescript
GET /api/permissions/{userId}
```

### ê¶Œí•œ ì—…ë°ì´íŠ¸
```typescript
PUT /api/permissions/{userId}
Body: {
  permissions: {
    "work-schedule": "read",
    ...
  },
  role: "user"
}
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ë¬¸ì„œ IDëŠ” ë°˜ë“œì‹œ Firebase Auth UIDì—¬ì•¼ í•©ë‹ˆë‹¤**
   - `userPermissions/{firebase_uid}` í˜•ì‹

2. **ê¶Œí•œì´ ì—†ëŠ” ê²½ìš°**
   - ë¬¸ì„œê°€ ì—†ìœ¼ë©´ ëª¨ë“  ì‹œìŠ¤í…œ ì ‘ê·¼ ë¶ˆê°€
   - ê¸°ë³¸ ê¶Œí•œì€ `none`ìœ¼ë¡œ ì²˜ë¦¬ë¨

3. **role ìš°ì„ ìˆœìœ„**
   - `super_admin` > `admin` > `user`
   - `super_admin`ì€ `permissions` í•„ë“œ ë¬´ì‹œí•˜ê³  ëª¨ë“  ê¶Œí•œ ë¶€ì—¬

4. **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**
   - Firestoreì˜ `onSnapshot`ì„ ì‚¬ìš©í•˜ì—¬ ê¶Œí•œ ë³€ê²½ ì‹œ ì‹¤ì‹œê°„ ë°˜ì˜

## ğŸ“‹ ì‹œìŠ¤í…œ ID ëª©ë¡

í˜„ì¬ ì§€ì›í•˜ëŠ” ì‹œìŠ¤í…œ ID:
- `work-schedule`: ê·¼ë¬´ì‹œê°„ ë° ê¸‰ì—¬ ê´€ë¦¬
- `purchase`: êµ¬ë§¤ ë¬¼í’ˆ ë¦¬ìŠ¤íŠ¸
- `naver-ranking`: ë„¤ì´ë²„ ìˆœìœ„ í™•ì¸
- `naver-refund`: ë„¤ì´ë²„ì˜ˆì•½ í™˜ë¶ˆì ‘ìˆ˜
- `ranking-tracker`: ë„¤ì´ë²„ ìˆœìœ„ ì¶”ì 
- `manual-management`: ë§¤ë‰´ì–¼ ê´€ë¦¬
- `chatbot-management`: ì±—ë´‡ ê´€ë¦¬
- `system-login`: ì‹œìŠ¤í…œ ë¡œê·¸ì¸ ì •ë³´

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

1. Firebase Console ì ‘ì†
2. Firestore Database â†’ ì»¬ë ‰ì…˜ ì‹œì‘
3. ì»¬ë ‰ì…˜ ID: `userPermissions`
4. ë¬¸ì„œ ID: ì‚¬ìš©ìì˜ Firebase Auth UID
5. ìœ„ ì˜ˆì‹œ ì¤‘ í•˜ë‚˜ë¥¼ ì°¸ê³ í•˜ì—¬ í•„ë“œ ì¶”ê°€
6. ì €ì¥

ì´ì œ í•´ë‹¹ ì‚¬ìš©ìëŠ” ì„¤ì •í•œ ê¶Œí•œì— ë”°ë¼ ì‹œìŠ¤í…œì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

