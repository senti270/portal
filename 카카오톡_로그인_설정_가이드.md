# 카카오톡 로그인 설정 가이드

## 📋 개요

카카오톡 로그인 시스템이 구현되었습니다. 다음 단계를 따라 설정하세요.

## 🔧 설정 단계

### 1. 카카오 개발자 콘솔 설정

1. [카카오 개발자 콘솔](https://developers.kakao.com/)에 접속
2. 내 애플리케이션 → 애플리케이션 추가하기
3. 앱 이름, 사업자명 입력 후 저장
4. 앱 키 → REST API 키 복사
5. 플랫폼 설정:
   - Web 플랫폼 추가
   - 사이트 도메인: `https://cdcdcd.kr` (프로덕션)
   - Redirect URI: `https://cdcdcd.kr/signup` (가입 페이지)
   - Redirect URI: `https://cdcdcd.kr` (로그인 페이지)
6. 제품 설정 → 카카오 로그인 활성화
7. Redirect URI 등록:
   - `https://cdcdcd.kr/signup`
   - `https://cdcdcd.kr`
   - `http://localhost:3000/signup` (개발용)
   - `http://localhost:3000` (개발용)

### 2. 환경 변수 설정

`.env.local` 파일에 다음을 추가:

```env
NEXT_PUBLIC_KAKAO_APP_KEY=your_kakao_rest_api_key
NEXT_PUBLIC_APP_URL=https://cdcdcd.kr
```

### 3. Firebase 설정

Firebase Authentication에서 다음을 확인:
- 이메일/비밀번호 인증 활성화 (이미 활성화되어 있음)
- Custom Token 생성 권한 (서버 사이드에서 필요)

## 📝 사용 방법

### 1. 초대링크 전송

1. **직원 관리** 페이지로 이동
2. 카카오톡 가입이 필요한 직원의 **"📱 초대링크"** 버튼 클릭
3. 생성된 초대링크가 클립보드에 복사됨
4. 해당 직원에게 초대링크 전송 (카카오톡, 문자 등)

### 2. 직원 가입 프로세스

1. 직원이 초대링크를 받아 클릭
2. 카카오톡 로그인 진행
3. 실명 입력 (직원 관리 데이터와 연결됨)
4. 가입 신청 완료
5. 관리자 승인 대기

### 3. 관리자 승인

1. **사용자 승인** 탭으로 이동
2. 대기 중인 가입 신청 확인
3. 실명과 직원 정보 일치 여부 확인
4. **승인** 또는 **거부** 버튼 클릭
5. 승인 시 직원 데이터에 Firebase UID와 카카오 ID 연결

### 4. 카카오톡 로그인

1. 로그인 페이지에서 **"카카오톡으로 로그인"** 버튼 클릭
2. 카카오톡 로그인 진행
3. 승인된 계정만 로그인 가능

## 🔐 보안 고려사항

### 현재 구현 상태

- ✅ 초대링크 시스템 (토큰 기반)
- ✅ 카카오톡 가입 페이지 (실명 입력)
- ✅ 관리자 승인 시스템
- ✅ 직원 데이터 연결
- ⚠️ 카카오톡 로그인 (Firebase Custom Token 생성 필요)

### 추가 작업 필요

카카오톡 로그인 완전 구현을 위해 다음이 필요합니다:

1. **서버 사이드 Custom Token 생성**
   - API Route 생성: `/api/work-schedule/auth/kakao-token`
   - Firebase Admin SDK 사용
   - 승인된 사용자의 Firebase UID로 Custom Token 생성
   - 클라이언트에서 Custom Token으로 로그인

2. **Firebase Admin SDK 설정**
   ```bash
   npm install firebase-admin
   ```
   
   서비스 계정 키 다운로드 및 설정

## 📁 생성된 파일

- `lib/kakao.ts` - 카카오 SDK 유틸리티
- `app/work-schedule/signup/page.tsx` - 카카오톡 가입 페이지
- `app/api/work-schedule/invitations/route.ts` - 초대링크 API
- `app/api/work-schedule/user-approvals/route.ts` - 사용자 승인 API
- `components/work-schedule/UserApprovalManagement.tsx` - 승인 관리 컴포넌트
- `components/work-schedule/AuthForm.tsx` - 로그인 폼 (카카오톡 로그인 추가)
- `components/work-schedule/EmployeeManagement.tsx` - 초대링크 전송 기능 추가

## 🎯 다음 단계

1. 카카오 개발자 콘솔에서 앱 키 발급
2. 환경 변수 설정
3. Firebase Custom Token 생성 API 구현 (선택사항, 현재는 기본 로그인만 가능)
4. 테스트 진행

## ⚠️ 주의사항

- 초대링크는 7일 후 자동 만료
- 한 번 사용된 초대링크는 재사용 불가
- 관리자 승인 전까지는 로그인 불가
- 직원 데이터에 `firebaseUid`와 `kakaoId` 필드가 자동으로 추가됨

